{% extends "base.html" %}

{% block title %}Dashboard - Panel de Administración{% endblock %}

{% block content %}
<!-- Barra de usuario autenticado -->
{% if user_id %}
  <div class="alert alert-success mb-3" role="alert">
    <i class="fas fa-user-check"></i> Usuario autenticado: <strong>{{ user_id }}</strong>
  </div>
  
{% else %}
  <div class="alert alert-danger mb-3" role="alert">
    <i class="fas fa-user-times"></i> No has iniciado sesión. El menú está deshabilitado.
  </div>
  <div class="alert alert-warning mb-3" role="alert">
    <i class="fas fa-bug"></i> <strong>DEBUG:</strong> Cookie user_id no encontrada o vacía.
  </div>
{% endif %}
<div class="dashboard-bg p-3" style="min-height: 100vh;">
    <div class="d-flex justify-content-between align-items-center mb-4 animate__animated animate__fadeInDown">
        <h1 class="fw-bold display-5 d-flex align-items-center">
            <span class="me-3"><i class="fas fa-tachometer-alt fa-2x text-primary animate__animated animate__bounceIn"></i></span>
            Dashboard Maestro Inventario
        </h1>
        <div>
            <a href="/admin/executive-dashboard" class="btn btn-primary btn-lg rounded-pill shadow animate__animated animate__pulse">
                <i class="fas fa-chart-line"></i> Dashboard Ejecutivo
            </a>
        </div>
    </div>

    <!-- Main Navigation Cards -->
    <div class="row mb-4 animate__animated animate__fadeInDown">
        <div class="col-md-4 mb-3">
            <div class="card border-primary h-100 shadow-lg rounded-4 nav-card">
                <div class="card-header bg-primary text-white d-flex align-items-center">
                    <h5 class="mb-0"><i class="fas fa-box fa-lg me-2"></i> Gestión de Productos</h5>
                </div>
                <div class="card-body">
                    <p>Administra tu catálogo de productos, categorías y marcas</p>
                    <div class="d-grid gap-2">
                        <a href="/admin/products" class="btn btn-outline-primary rounded-pill fw-bold">
                            <i class="fas fa-boxes"></i> Productos
                        </a>
                        <a href="/admin/categories" class="btn btn-outline-primary rounded-pill fw-bold">
                            <i class="fas fa-tags"></i> Categorías
                        </a>
                        <a href="/admin/brands" class="btn btn-outline-primary rounded-pill fw-bold">
                            <i class="fas fa-trademark"></i> Marcas
                        </a>
                        <a href="/admin/articles" class="btn btn-outline-success rounded-pill fw-bold">
                            <i class="fas fa-analytics"></i> Análisis de Artículos
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-3">
            <div class="card border-success h-100 shadow-lg rounded-4 nav-card">
                <div class="card-header bg-success text-white d-flex align-items-center">
                    <h5 class="mb-0"><i class="fas fa-truck fa-lg me-2"></i> Operaciones</h5>
                </div>
                <div class="card-body">
                    <p>Gestiona proveedores, almacenes y operaciones</p>
                    <div class="d-grid gap-2">
                        <a href="/admin/suppliers" class="btn btn-outline-success rounded-pill fw-bold">
                            <i class="fas fa-handshake"></i> Proveedores
                        </a>
                        <a href="/admin/warehouses" class="btn btn-outline-success rounded-pill fw-bold">
                            <i class="fas fa-warehouse"></i> Almacenes
                        </a>
                        <a href="/admin/purchase-orders" class="btn btn-outline-warning rounded-pill fw-bold">
                            <i class="fas fa-shopping-cart"></i> Órdenes de Compra
                        </a>
                    </div>
                </div>
            </div>
        </div>
        <div class="col-md-4 mb-3">
            <div class="card border-info h-100 shadow-lg rounded-4 nav-card">
                <div class="card-header bg-info text-white d-flex align-items-center">
                    <h5 class="mb-0"><i class="fas fa-chart-bar fa-lg me-2"></i> Análisis e Inventario</h5>
                </div>
                <div class="card-body">
                    <p>Reportes, análisis y control de inventario</p>
                    <div class="d-grid gap-2">
                        <a href="/admin/inventory-movements" class="btn btn-outline-info rounded-pill fw-bold">
                            <i class="fas fa-exchange-alt"></i> Movimientos Inventario
                        </a>
                        <a href="/admin/executive-dashboard" class="btn btn-outline-danger rounded-pill fw-bold">
                            <i class="fas fa-chart-line"></i> Dashboard Ejecutivo
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Estadísticas Principales -->
    <div class="row mb-4 animate__animated animate__fadeInDown">
        <div class="col-lg-3 col-md-6 mb-3">
            <div class="card bg-primary text-white stat-card shadow-lg rounded-4">
                <div class="card-body d-flex justify-content-between align-items-center">
                    <div>
                        <h2 class="fw-bold mb-1">{{ stats.total_products }}</h2>
                        <div class="fs-6">Total Productos</div>
                    </div>
                    <i class="fas fa-boxes fa-3x opacity-75"></i>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-6 mb-3">
            <div class="card bg-success text-white stat-card shadow-lg rounded-4">
                <div class="card-body d-flex justify-content-between align-items-center">
                    <div>
                        <h2 class="fw-bold mb-1">{{ stats.active_products }}</h2>
                        <div class="fs-6">Productos Activos</div>
                    </div>
                    <i class="fas fa-check-circle fa-3x opacity-75"></i>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-6 mb-3">
            <div class="card bg-info text-white stat-card shadow-lg rounded-4">
                <div class="card-body d-flex justify-content-between align-items-center">
                    <div>
                        <h2 class="fw-bold mb-1">{{ stats.total_categories }}</h2>
                        <div class="fs-6">Categorías</div>
                    </div>
                    <i class="fas fa-tags fa-3x opacity-75"></i>
                </div>
            </div>
        </div>
        <div class="col-lg-3 col-md-6 mb-3">
            <div class="card bg-warning text-white stat-card shadow-lg rounded-4">
                <div class="card-body d-flex justify-content-between align-items-center">
                    <div>
                        <h2 class="fw-bold mb-1">{{ stats.total_brands }}</h2>
                        <div class="fs-6">Marcas</div>
                    </div>
                    <i class="fas fa-trademark fa-3x opacity-75"></i>
                </div>
            </div>
        </div>
    </div>

    <!-- Problems Alert -->
    {% if stats.products_without_category > 0 or stats.products_without_brand > 0 %}
    <div class="alert alert-warning mb-4 animate__animated animate__fadeInDown shadow rounded-4 d-flex flex-column">
        <h5 class="mb-2 d-flex align-items-center">
            <i class="fas fa-exclamation-triangle fa-lg text-warning me-2 animate__animated animate__shakeX"></i>
            Productos con relaciones incompletas
        </h5>
        <ul class="mb-0 ps-4">
            {% if stats.products_without_category > 0 %}
            <li><span class="fw-bold text-danger">{{ stats.products_without_category }}</span> productos sin categoría</li>
            {% endif %}
            {% if stats.products_without_brand > 0 %}
            <li><span class="fw-bold text-danger">{{ stats.products_without_brand }}</span> productos sin marca</li>
            {% endif %}
        </ul>
        <hr class="my-2">
        <div class="d-flex gap-2">
            <a href="/admin/products?has_category=false" class="btn btn-outline-warning btn-sm rounded-pill animate__animated animate__pulse">
                <i class="fas fa-eye"></i> Ver productos sin categoría
            </a>
            <a href="/admin/products?has_brand=false" class="btn btn-outline-warning btn-sm rounded-pill animate__animated animate__pulse">
                <i class="fas fa-eye"></i> Ver productos sin marca
            </a>
        </div>
    </div>
    {% endif %}

    <div class="row">
        <!-- Top Categories -->
        <div class="col-md-6">
            <div class="table-container animate__animated animate__fadeInUp">
                <h5>
                    <i class="fas fa-tags fa-lg text-primary me-2"></i> Top Categorías por Productos
                    <span class="ms-2" data-bs-toggle="tooltip" title="Las categorías con más productos registrados">
                        <i class="fas fa-info-circle text-secondary"></i>
                    </span>
                </h5>
                {% if top_categories %}
                <table class="table table-striped table-hover rounded-4 shadow-lg">
                    <thead class="table-light">
                        <tr>
                            <th class="align-middle"><i class="fas fa-tag fa-lg text-primary"></i> Categoría</th>
                            <th class="align-middle"><i class="fas fa-box fa-lg text-info"></i> Productos</th>
                            <th class="align-middle"><i class="fas fa-cogs fa-lg text-secondary"></i> Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for category in top_categories %}
                        <tr class="align-middle animate__animated animate__fadeIn table-row-hover">
                            <td>
                                <span class="fw-bold fs-6">
                                    {{ category[0] if category[0] else 'Sin categoría' }}
                                </span>
                            </td>
                            <td>
                                <span class="badge bg-primary fs-6 px-3 py-2 shadow-lg rounded-pill">
                                    {{ category[1] }}
                                </span>
                            </td>
                            <td>
                                {% if category[0] %}
                                <a href="/admin/products?category_name={{ category[0] }}" class="btn btn-sm btn-outline-primary rounded-pill animate__animated animate__pulse action-btn" data-bs-toggle="tooltip" title="Ver productos de esta categoría">
                                    <i class="fas fa-eye"></i>
                                </a>
                                {% else %}
                                <a href="/admin/products?has_category=false" class="btn btn-sm btn-outline-warning rounded-pill animate__animated animate__pulse action-btn" data-bs-toggle="tooltip" title="Ver productos sin categoría">
                                    <i class="fas fa-eye"></i>
                                </a>
                                {% endif %}
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                {% else %}
                <p class="text-muted">No hay categorías registradas</p>
                {% endif %}
                <div class="text-center mt-2">
                    <a href="/admin/categories" class="btn btn-primary rounded-pill">
                        <i class="fas fa-list"></i> Ver todas las categorías
                    </a>
                </div>
            </div>
        </div>

        <!-- Top Brands -->
        <div class="col-md-6">
            <div class="table-container animate__animated animate__fadeInUp">
                <h5>
                    <i class="fas fa-trademark fa-lg text-success me-2"></i> Top Marcas por Productos
                    <span class="ms-2" data-bs-toggle="tooltip" title="Las marcas con más productos registrados">
                        <i class="fas fa-info-circle text-secondary"></i>
                    </span>
                </h5>
                {% if top_brands %}
                <table class="table table-striped table-hover rounded-4 shadow-lg">
                    <thead class="table-light">
                        <tr>
                            <th class="align-middle"><i class="fas fa-trademark fa-lg text-success"></i> Marca</th>
                            <th class="align-middle"><i class="fas fa-box fa-lg text-info"></i> Productos</th>
                            <th class="align-middle"><i class="fas fa-cogs fa-lg text-secondary"></i> Acciones</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for brand in top_brands %}
                        <tr class="align-middle animate__animated animate__fadeIn table-row-hover">
                            <td>
                                <span class="fw-bold fs-6">
                                    {{ brand[0] if brand[0] else 'Sin marca' }}
                                </span>
                            </td>
                            <td>
                                <span class="badge bg-success fs-6 px-3 py-2 shadow-lg rounded-pill">
                                    {{ brand[1] }}
                                </span>
                            </td>
                            <td>
                                {% if brand[0] %}
                                <a href="/admin/products?brand_name={{ brand[0] }}" class="btn btn-sm btn-outline-success rounded-pill animate__animated animate__pulse action-btn" data-bs-toggle="tooltip" title="Ver productos de esta marca">
                                    <i class="fas fa-eye"></i>
                                </a>
                                {% else %}
                                <a href="/admin/products?has_brand=false" class="btn btn-sm btn-outline-warning rounded-pill animate__animated animate__pulse action-btn" data-bs-toggle="tooltip" title="Ver productos sin marca">
                                    <i class="fas fa-eye"></i>
                                </a>
                                {% endif %}
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                {% else %}
                <p class="text-muted">No hay marcas registradas</p>
                {% endif %}
                <div class="text-center mt-2">
                    <a href="/admin/brands" class="btn btn-success rounded-pill">
                        <i class="fas fa-list"></i> Ver todas las marcas
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="row mt-4">
        <div class="col-md-12">
            <div class="table-container animate__animated animate__fadeInUp">
                <h5><i class="fas fa-bolt text-warning"></i> Acciones Rápidas</h5>
                <div class="row">
                    <div class="col-md-3">
                        <a href="/admin/products" class="btn btn-outline-primary btn-lg w-100 mb-3 rounded-pill shadow animate__animated animate__pulse quick-action-btn">
                            <i class="fas fa-box fa-2x mb-2"></i><br>
                            <span class="fw-bold">Gestionar Productos</span>
                        </a>
                    </div>
                    <div class="col-md-3">
                        <a href="/admin/categories" class="btn btn-outline-info btn-lg w-100 mb-3 rounded-pill shadow animate__animated animate__pulse quick-action-btn">
                            <i class="fas fa-tags fa-2x mb-2"></i><br>
                            <span class="fw-bold">Gestionar Categorías</span>
                        </a>
                    </div>
                    <div class="col-md-3">
                        <a href="/admin/brands" class="btn btn-outline-success btn-lg w-100 mb-3 rounded-pill shadow animate__animated animate__pulse quick-action-btn">
                            <i class="fas fa-trademark fa-2x mb-2"></i><br>
                            <span class="fw-bold">Gestionar Marcas</span>
                        </a>
                    </div>
                    <div class="col-md-3">
                        <a href="/docs" target="_blank" class="btn btn-outline-dark btn-lg w-100 mb-3 rounded-pill shadow animate__animated animate__pulse quick-action-btn">
                            <i class="fas fa-book fa-2x mb-2"></i><br>
                            <span class="fw-bold">API Docs</span>
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- System Status -->
    <div class="row mt-4">
        <div class="col-md-12">
            <div class="table-container animate__animated animate__fadeInUp">
                <h5><i class="fas fa-info-circle text-info"></i> Estado del Sistema</h5>
                <div class="row">
                    <div class="col-md-4 mb-3">
                        <div class="status-card p-3 rounded shadow-sm bg-white d-flex flex-column align-items-center">
                            <strong class="mb-2"><i class="fas fa-check-circle text-success fa-lg me-2"></i> Productos Activos</strong>
                            <div class="progress mb-2 w-100" style="height: 12px;">
                                <div class="progress-bar bg-success status-bar" 
                                     data-active="{{ stats.active_products }}"
                                     data-total="{{ stats.total_products }}"
                                     data-type="active"></div>
                            </div>
                            <span class="fs-5 fw-bold text-success">{{ stats.active_products }}</span>
                            <small class="text-muted">de {{ stats.total_products }} productos</small>
                        </div>
                    </div>
                    <div class="col-md-4 mb-3">
                        <div class="status-card p-3 rounded shadow-sm bg-white d-flex flex-column align-items-center">
                            <strong class="mb-2"><i class="fas fa-tags text-info fa-lg me-2"></i> Productos con Categoría</strong>
                            <div class="progress mb-2 w-100" style="height: 12px;">
                                <div class="progress-bar bg-info status-bar"
                                     data-with-category="{{ stats.total_products - stats.products_without_category }}"
                                     data-total="{{ stats.total_products }}"
                                     data-type="category"></div>
                            </div>
                            <span class="fs-5 fw-bold text-info">{{ stats.total_products - stats.products_without_category }}</span>
                            <small class="text-muted">de {{ stats.total_products }} productos</small>
                        </div>
                    </div>
                    <div class="col-md-4 mb-3">
                        <div class="status-card p-3 rounded shadow-sm bg-white d-flex flex-column align-items-center">
                            <strong class="mb-2"><i class="fas fa-trademark text-warning fa-lg me-2"></i> Productos con Marca</strong>
                            <div class="progress mb-2 w-100" style="height: 12px;">
                                <div class="progress-bar bg-warning status-bar"
                                     data-with-brand="{{ stats.total_products - stats.products_without_brand }}"
                                     data-total="{{ stats.total_products }}"
                                     data-type="brand"></div>
                            </div>
                            <span class="fs-5 fw-bold text-warning">{{ stats.total_products - stats.total_products }}</span>
                            <small class="text-muted">de {{ stats.total_products }} productos</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Sección de Status de Conexión y Base de Datos -->
    <div class="row mb-4">
        <div class="col-md-6">
            <div class="card border-secondary shadow-lg animate__animated animate__fadeInUp">
                <div class="card-header bg-secondary text-white d-flex align-items-center">
                    <h5 class="mb-0"><i class="fas fa-database me-2"></i> Estado de la Conexión y Base de Datos</h5>
                </div>
                <div class="card-body">
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item d-flex align-items-center">
                            <strong class="me-2"><i class="fas fa-link"></i> Status conexión API:</strong>
                            {% if db_status and db_status.startswith('OK') %}
                                <span class="badge bg-success px-3 py-2 shadow"><i class="fas fa-check-circle"></i> Conectado</span>
                            {% else %}
                                <span class="badge bg-danger px-3 py-2 shadow"><i class="fas fa-times-circle"></i> {{ db_status }}</span>
                            {% endif %}
                        </li>
                        {% if db_info %}
                        <li class="list-group-item d-flex align-items-center"><strong class="me-2"><i class="fas fa-globe"></i> URL:</strong> <code class="bg-light px-2 py-1 rounded">{{ db_info.url }}</code></li>
                        <li class="list-group-item d-flex align-items-center"><strong class="me-2"><i class="fas fa-plug"></i> Driver:</strong> <span class="badge bg-info text-dark px-2">{{ db_info.driver }}</span></li>
                        <li class="list-group-item d-flex align-items-center"><strong class="me-2"><i class="fas fa-database"></i> Base de datos:</strong> <span class="badge bg-secondary px-2">{{ db_info.database }}</span></li>
                        <li class="list-group-item d-flex align-items-center"><strong class="me-2"><i class="fas fa-server"></i> Host:</strong> <span class="badge bg-light text-dark px-2">{{ db_info.host }}</span></li>
                        <li class="list-group-item d-flex align-items-center"><strong class="me-2"><i class="fas fa-network-wired"></i> Puerto:</strong> <span class="badge bg-light text-dark px-2">{{ db_info.port }}</span></li>
                        <li class="list-group-item d-flex align-items-center"><strong class="me-2"><i class="fas fa-user"></i> Usuario:</strong> <span class="badge bg-light text-dark px-2">{{ db_info.user }}</span></li>
                        {% endif %}
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <style>
    .table-container {
        background: white;
        padding: 20px;
        border-radius: 16px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.12);
        margin-bottom: 20px;
        animation-duration: 0.7s;
    }
    .table {
        border-radius: 16px !important;
        box-shadow: 0 4px 18px rgba(0,0,0,0.10) !important;
        overflow: hidden;
        font-size: 1em;
    }
    .table thead th {
        font-weight: 600;
        font-size: 1.08em;
        background: #f8f9fa;
        border-bottom: 2px solid #e9ecef;
    }
    .table-hover tbody tr:hover {
        background-color: #e3f2fd !important;
        transition: background 0.2s;
    }
    .badge {
        font-size: 1em;
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.10);
        font-weight: 600;
    }
    .btn-sm {
        font-size: 0.95em;
        padding: 6px 14px;
    }
    .rounded-pill {
        border-radius: 50rem !important;
    }
    .card-header {
        font-size: 1.1em;
        font-weight: 600;
        letter-spacing: 0.5px;
    }
    .card.shadow-lg {
        box-shadow: 0 6px 24px rgba(0,0,0,0.15) !important;
    }
    .list-group-item {
        font-size: 1em;
        border: none;
        background: transparent;
        transition: background 0.2s;
    }
    .list-group-item strong {
        min-width: 140px;
        display: inline-block;
    }
    .list-group-item code {
        font-size: 0.95em;
    }
    .quick-action-btn {
        transition: transform 0.18s, box-shadow 0.18s;
    }
    .quick-action-btn:hover {
        transform: translateY(-3px) scale(1.04);
        box-shadow: 0 8px 24px rgba(0,0,0,0.18);
        background: #f8f9fa;
    }
    .quick-action-btn i {
        transition: color 0.2s;
    }
    .quick-action-btn:hover i {
        color: #0d6efd;
    }
    .status-card {
        transition: box-shadow 0.2s, transform 0.2s;
        border-radius: 16px;
        box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        background: #fff;
    }
    .status-card:hover {
        box-shadow: 0 8px 24px rgba(0,0,0,0.14);
        transform: translateY(-2px) scale(1.02);
    }
    .stat-card {
        border-radius: 18px !important;
        box-shadow: 0 6px 24px rgba(0,0,0,0.13) !important;
        transition: box-shadow 0.2s, transform 0.2s;
    }
    .stat-card:hover {
        box-shadow: 0 12px 32px rgba(0,0,0,0.18) !important;
        transform: translateY(-2px) scale(1.03);
    }
    .stat-card h2 {
        font-size: 2.3em;
        margin-bottom: 0.2em;
    }
    .stat-card i {
        filter: drop-shadow(0 2px 6px rgba(0,0,0,0.12));
    }
    .alert-warning {
        border-radius: 18px;
        box-shadow: 0 4px 18px rgba(255,193,7,0.13);
        border: none;
        background: linear-gradient(90deg, #fffbe6 80%, #fff3cd 100%);
        color: #856404;
    }
    .alert-warning h5 {
        font-weight: 600;
        font-size: 1.15em;
    }
    .alert-warning .btn-outline-warning {
        font-weight: 500;
        transition: background 0.18s, color 0.18s;
    }
    .alert-warning .btn-outline-warning:hover {
        background: #ffe082;
        color: #856404;
    }
    .nav-card {
        border-radius: 18px !important;
        box-shadow: 0 6px 24px rgba(0,0,0,0.13) !important;
        transition: box-shadow 0.2s, transform 0.2s;
    }
    .nav-card:hover {
        box-shadow: 0 12px 32px rgba(0,0,0,0.18) !important;
        transform: translateY(-2px) scale(1.03);
    }
    .nav-card .card-header {
        font-size: 1.15em;
        font-weight: 700;
        letter-spacing: 0.5px;
        border-radius: 18px 18px 0 0 !important;
    }
    .nav-card .btn {
        font-size: 1.08em;
        padding: 10px 0;
        transition: background 0.18s, color 0.18s, box-shadow 0.18s;
    }
    .nav-card .btn:hover {
        background: #f8f9fa;
        color: #212529;
        box-shadow: 0 2px 8px rgba(0,0,0,0.10);
    }
    .dashboard-bg {
        background: linear-gradient(120deg, #f8fafc 70%, #e3f2fd 100%);
        min-height: 100vh;
        box-shadow: 0 2px 24px rgba(0,0,0,0.07);
        border-radius: 24px;
        padding-bottom: 40px;
        transition: background 0.5s;
    }
    body {
        background: #f4f6fb;
    }
    .table-row-hover {
        transition: background 0.18s, transform 0.18s;
    }
    .table-row-hover:hover {
        background: #e3f2fd !important;
        transform: scale(1.015);
        box-shadow: 0 2px 12px rgba(0,0,0,0.10);
        z-index: 2;
    }
    .action-btn {
        transition: transform 0.18s, box-shadow 0.18s;
    }
    .action-btn:hover {
        transform: scale(1.12);
        box-shadow: 0 4px 16px rgba(0,123,255,0.13);
    }
    .dashboard-footer {
        background: linear-gradient(90deg, #f8fafc 80%, #e3f2fd 100%);
        border-radius: 0 0 24px 24px;
        box-shadow: 0 -2px 18px rgba(0,0,0,0.07);
        font-size: 1.08em;
        position: relative;
        left: 0;
        bottom: 0;
        width: 100%;
        z-index: 10;
    }
    </style>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        document.body.classList.add('animate__animated', 'animate__fadeIn');
        // Calcular y animar anchuras de barras de progreso
        const progressBars = document.querySelectorAll('.progress-bar[data-type]');
        progressBars.forEach(bar => {
            const type = bar.dataset.type;
            const total = parseInt(bar.dataset.total) || 1;
            let current = 0;
            let percentage = 0;
            if (type === 'active') {
                current = parseInt(bar.dataset.active) || 0;
            } else if (type === 'category') {
                current = parseInt(bar.dataset.withCategory) || 0;
            } else if (type === 'brand') {
                current = parseInt(bar.dataset.withBrand) || 0;
            }
            percentage = total > 0 ? (current / total * 100) : 0;
            bar.style.width = '0%';
            setTimeout(() => {
                bar.style.width = percentage + '%';
            }, 200);
            // Agregar tooltip con información
            bar.setAttribute('title', `${current} de ${total} (${percentage.toFixed(1)}%)`);
        });
        // Activar tooltips Bootstrap
        var tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
        var tooltipList = tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl);
        });
    });
    </script>
</div>

<footer class="dashboard-footer mt-4 py-3 text-center animate__animated animate__fadeInUp">
    <div class="container">
        <span class="text-muted">
            <i class="fas fa-cube text-primary me-2"></i>
            Maestro Inventario &copy; {{ today.strftime('%d/%m/%Y') }} &mdash; Todos los derechos reservados
        </span>
    </div>
</footer>
{% endblock %}
